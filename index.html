<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phasmophobia Broads HQ</title>

  <link rel="stylesheet" href="styles/style.css" />
  <link rel="stylesheet" href="styles/animations.css" />
  <link rel="stylesheet" href="styles/hunt.css" />

  <script type="importmap">
    {
      "imports": {
        "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
        "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js": "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"
      }
    }
  </script>
</head>

<body>

<header>
  <h1>PHASMOPHOBIA BROADS HQ</h1>
  <p>Private ghost-hunting hub for your squad</p>
</header>

<nav>
  <button class="tab-btn active" data-target="panel-chat">Chat</button>
  <button class="tab-btn" data-target="panel-evidence">Evidence</button>
  <button class="tab-btn" data-target="panel-status">Player Status</button>
  <button class="tab-btn" data-target="panel-locations">Locations</button>
  <button class="tab-btn" data-target="panel-ghostlog">Ghost Log</button>
  <button class="tab-btn" data-target="panel-casefiles">Case Files</button>
  <button class="tab-btn" data-target="panel-lobby">Lobby / Voice</button>
</nav>

<main>

  <section id="panel-chat" class="panel active">
    <h2>Van Radio Chat</h2>

    <div id="chat-log"></div>

    <form id="chat-form">
      <input id="chat-input" type="text" autocomplete="off"
        placeholder="Type or use commands: !hunt, !flicker, !manifest…" />
      <button type="submit">Send</button>
    </form>
  </section>

  <section id="panel-evidence" class="panel">
    <h2>Evidence Tracker</h2>
    <p>Try: <code>!evidence: EMF 5</code></p>
    <div id="evidence-list"></div>
  </section>

  <section id="panel-status" class="panel">
    <h2>Player Status</h2>
    <p>Commands: <code>!dead: NAME</code> | <code>!revive: NAME</code></p>
    <div id="status-list"></div>
  </section>

  <section id="panel-locations" class="panel">
    <h2>Player Locations</h2>
    <p>Example: <code>!location: Starla → Basement</code></p>
    <div id="location-list"></div>
  </section>

  <section id="panel-ghostlog" class="panel">
    <h2>Ghost Activity Log</h2>
    <div id="ghost-log"></div>
  </section>

  <section id="panel-casefiles" class="panel">
    <h2>Case Files</h2>

    <div class="case-grid">

      <div class="case-card" onclick="openPoster(1)">
        <img src="assets/posters/poster1.png" />
        <div>Summoning Circle</div>
      </div>

      <div class="case-card" onclick="openPoster(2)">
        <img src="assets/posters/poster2.png" />
        <div>Dragged From the Van</div>
      </div>

      <div class="case-card" onclick="openPoster(3)">
        <img src="assets/posters/poster3.png" />
        <div>Voodoo Doll Tackle</div>
      </div>

      <div class="case-card" onclick="openPoster(4)">
        <img src="assets/posters/poster4.png" />
        <div>Ouija Board Chaos</div>
      </div>

      <div class="case-card" onclick="openPoster(5)">
        <img src="assets/posters/poster5.png" />
        <div>Running From Ghost</div>
      </div>

      <div class="case-card" onclick="openPoster(6)">
        <img src="assets/posters/poster6.png" />
        <div>Ghost Writing</div>
      </div>

    </div>

    <div id="poster-modal" class="poster-modal" onclick="closePoster()">
      <span class="poster-close">&times;</span>
      <img id="poster-modal-img" />
      <p id="poster-caption"></p>
    </div>

  </section>

  <section id="panel-lobby" class="panel">
    <h2>Lobby / Voice Chat</h2>
    <button onclick="openJitsi()">Open Voice / Video</button>
  </section>

</main>

<footer>
  <p>© <span id="year"></span> Phasmophobia Broads HQ</p>
</footer>

<script type="module" src="scripts/firebase.js"></script>
<script type="module" src="scripts/main.js"></script>
<script type="module" src="scripts/commands.js"></script>
<script type="module" src="scripts/hunt.js"></script>
<script type="module" src="scripts/uiEffects.js"></script>
<script type="module" src="scripts/ghostEvents.js"></script>
<script type="module" src="scripts/lobby.js"></script>
<script type="module" src="scripts/voice.js"></script>
<script type="module" src="scripts/casefiles.js"></script>
<script type="module" src="scripts/chat.js"></script>


<script>
  // These functions are defined here to work directly with the HTML onclick attributes.
  function openPoster(num) {
    const modal = document.getElementById("poster-modal");
    const img = document.getElementById("poster-modal-img");
    const caption = document.getElementById("poster-caption");

    const labels = [
      "Summoning Circle",
      "Dragged From the Van",
      "Voodoo Doll Tackle",
      "Ouija Board Chaos",
      "Running From Ghost",
      "Ghost Writing"
    ];

    // NOTE: This image path is wrong for the new structure! It should be updated
    // in your assets folder structure. I'm leaving the original path to avoid
    // modifying the structure you may already have, but it's a potential fix point.
    img.src = `assets/posters/poster${num}.png`; 
    caption.textContent = labels[num - 1];
    modal.style.display = "block";
  }

  function closePoster() {
    document.getElementById("poster-modal").style.display = "none";
  }

  function openJitsi() {
    // NOTE: If you decide to use the openVoiceChat function from scripts/voice.js, 
    // you would call window.openVoiceChat() here instead.
    window.open("https://meet.jit.si/PhasmophobiaBroadsHQ", "_blank");
  }

  document.getElementById("year").textContent = new Date().getFullYear();
</script>

</body>
</html>
